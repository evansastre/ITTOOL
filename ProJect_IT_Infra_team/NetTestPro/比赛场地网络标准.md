一、测试项目：
1. IP 包传输往返时延(RTT)
2. IP 包时延变化(抖动)
3. IP 包丢失率(Lost rate)
4. IP 业务可用性
5. 带宽(Bandwidth)

二、适用标准：
中华人民共和国信息产业部令第 36 号
RFC 1242/RFC1944/RFC2285/RFC2432
http://www.mofcom.gov.cn/aarticle/b/g/200505/20050500098639.html
IP 网络技术要求– 网络性能参数与指标(YD/T 1171-2001) 相关细则如下：
～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
3.2.2 因特网数据传送业务的通信质量指标
本小节规定的通信质量指标，范围限定在两个业务接入点之间，即把公众用户产生的 IP 包，从运营
商位于某个城市的业务接入点开始，跨越全国性骨干网，传送到该运营商在另外一个城市的业务接入
点止(不含城域网部分)。考核这些业务指标时，两个业务接入点选择在不同省的两个城市，并且空中
距离超过 1000 公里。
3.2.2.1 IP 包传输往返时延
往返时延平均值≤200 毫秒。
IP 包传输往返时延指从一个平均包长的 IP 包的最后一个比特进入因特网业务接入点(A 点)，到达对端
的业务接入点(B 点)，再返回进入时的接入点(A 点)止的时间。
3.2.2.2 IP 包时延变化
时延变化平均值≤80 毫秒。
IP 包时延变化指在一段测量时间间隔内，IP 包最大传输时延与 IP 包最小传输时延的差值。
3.2.2.3 IP 包丢失率
包丢失率平均值≤2%。
IP 包丢失率指 IP 包在两点间传输时丢失的概率。
3.2.2.4 IP 业务可用性
IP 业务可用性≥99.9％。
IP 业务可用性指用户能够使用 IP 业务的时间与 IP 业务全部工作时间之比。在连续 5 分钟内，如果一
个 IP 网络所提供业务的丢包率≤75％，则认为该时间段是可用的，否则是不可用的。
～～～～～～～～～～～～～～～～～～～～～～～～

三、测试平台和工具：
部分工具仅支持 Linux 系统，此处仅供了解测试步骤和分析方法。
1、iperf 网络带宽测试工具
2、paratrace 被动路由测试工具(Linux)
3、hping2 网络联通和时延测试工具(Linux)
4、wireshark(ethereal) 抓包分析工具
5、p0f 被动指纹分析工具(Linux)

四、测试对象，方法，和结果分析：
1.测试网络带宽
在服务器端运行 iperf -s。
在客户端运行 iperf -c 服务器 IP 地址
比如在 100Mbps 网络环境下，得到结果为 92.6Mbps，折合为 11.5MB/s。即数据极限传输速度。
2.测试网络 IP 包传输往返时延(RTT)和 IP 包时延变化(抖动)
分主动被动方法，被动方法用 wireshark 抓包分析。下面主要介绍主动方法：
运行 hping2 www.qq.com -p 80。得到
56 packets transmitted, 56 packets received, 0% packet loss
round-trip min/avg/max = 242.5/269.9/381.1 ms
即在主动建立的到 www.qq.com 的 TCP 连接中(默认为 TCP，可以使用 UDP，ICMP，IP，具体请看
hping2 –help)，丢包率为 0。平均传输延迟为 269.9，抖动为 138.6。
注：按照《中华人民共和国信息产业部令第 36 号》，往返时延平均值≤200 毫秒，时延变化平均值≤80
毫秒。此处已经超标。但因为测试环境和适用条件不完全吻合，因此无法作为有效证据。
3.IP 包丢失率(Lost rate)
也分主动方法和被动方法，主动方法见上。
被动方法是用 wireshark 抓包后，通过 tpc.analysis.lost_segment 标志分析丢包数量和总体数量。
具体为。用 wireshark 抓包。
用 (tcp.srcport==7007||tcp.dstport==
7007)&&(tcp.analysis.retransmission||tcp.analysis.lost_segment||tcp.analysis.ack_lost_segme
nt)过滤。7007 为 aMule 端口。
另存，其中会显示丢包和总体数目。此处一般都 3%-9%。
用 (tcp.srcport!=7007&&tcp.dstport!=
7007)&&(tcp.analysis.retransmission||tcp.analysis.lost_segment||tcp.analysis.ack_lost_segme
nt)过滤。

另外，此时是非 7007 端口丢包和总体数目。此处一般是 0.18%-0.32%。
主动方法在测试网络硬性联通上比较方便，但是对于特殊封锁造成的丢包(例如 BT/ED 封锁)。由于主
动 TCP 测试不会被封锁，因此无法得到有效数据。需要在实际环境中使用被动方法测试。
此处丢包率总体值一般都超过了 3%，根据《中华人民共和国信息产业部令第 36 号》，IP 包丢失率平
均值≤2％。此处已经超标，但基于和上文同样理由，无法作为有效证据。
4.IP 业务可用性
如果在测试中，连续 5 分钟平均丢包超过 75%，则可以认定为无效。
5.问题出现点定位
假定出现问题，那么我们可以假设，问题应当出现在从当前机器到目标机器中的某个路由器上。
如果多个目标机器通讯出现问题，我们可以猜测，问题很大可能出现在这些机器共同经过的某个路由
器上。
所以，我们需要跟踪每个 IP 的连接。windows 下是 tracert。
$traceroute www.google.com
1 192.168.0.1 (192.168.0.1) 2 ms 1 ms 0 ms
2 10.119.16.1 (10.119.16.1) 23 ms 25 ms 13 ms
3 reserve.cableplus.com.cn (219.233.244.141) 15 ms 11 ms 16 ms
4 * * *
5 reserve.cableplus.com.cn (219.233.238.205) 14 ms 10 ms 18 ms
6 202.96.222.77 (202.96.222.77) 13 ms 15 ms 14 ms
7 202.101.63.226 (202.101.63.226) 32 ms 19 ms 17 ms
8 202.97.33.38 (202.97.33.38) 84 ms 78 ms 82 ms
9 202.97.33.178 (202.97.33.178) 61 ms 65 ms 69 ms
10 202.97.4.46 (202.97.4.46) 106 ms 103 ms 104 ms
11 216.239.47.232 (216.239.47.232) 94 ms 99 ms 112 ms
12 216.239.47.237 (216.239.47.237) 224 ms 195 ms 196 ms
13 72.14.233.53 (72.14.233.53) 185 ms 181 ms 195 ms
14 72.14.232.139 (72.14.232.139) 208 ms 213 ms 240 ms
15 72.14.233.129 (72.14.233.129) 205 ms 66.249.94.227 (66.249.94.227) 193 ms
209 ms
16 72.14.233.131 (72.14.233.131) 193 ms 195 ms 202 ms
17 216.239.49.66 (216.239.49.66) 209 ms 204 ms 244 ms
18 66.102.7.99 (66.102.7.99) 198 ms 193 ms 195 ms
当然，如果是禁止了 ICMP TTL 超时的死报文回复。就会测定不出路由，这时候需要用 paratrace。
结果是一样的，不过没有被封锁的危险。

网络相关
1）电信 ISP 线路问题
导致游戏卡顿，掉线，影响主舞台以及直播推流
联系网络供应商报障
2）网络控制器性能问题
导致网络延迟波动
每站结束后设备检查后入库，确认现有设备的硬件资源使用率是否接近饱和。
需准备足够数量的桌面交换机以及备用设备。
3）笔记本连接网线后无法获取到 IP 地址
导致原因：DHCP 池范围过小导致
解决方法：根据比赛设备数量，扩充 IP 地址池。
4）比赛现场观看直播平台无弹幕
导致原因：网络供应商提供的 DNS 服务器问题
解决办法：切换到其他更稳定的 DNS 服务器
5）平台直播间接性黑屏
导致原因：测试比赛现场到推流服务器存在丢包
解决方法：切换到备用推流服务器后解决该问题
网络搭建完成后，与供应商进行推流测试